import React, { useEffect } from "react"
import styled from "styled-components"
import { Gutenberg } from "../organisms/gutenberg-wrapper"
import Navigation from "../organisms/post-navigation"
import HTMLReactParser from "html-react-parser"
import useHeadings from "../../hooks/create-headings"
import { slugTransform } from "../../utils/slug-transform"

export default function Content({ data }) {
  const headings = useHeadings(data)

  useEffect(() => {
    document.getElementById('content').querySelectorAll('h2').forEach(el => {
      el.id = slugTransform(el.innerText)
    })
  }, [])


  return (
    <Wrapper>
      <div className="container">
        <Navigation headings={headings} />
        <Gutenberg id='content'>{HTMLReactParser(data)}</Gutenberg>
        <svg xmlns="http://www.w3.org/2000/svg" className="rune" width="63" height="50" fill="none" viewBox="0 0 63 50"><path fill="#9AACB8" d="M7.402 10.53c-.574-1.502-1.574-2.365-2.684-3.193C2.792 5.903 1.417 3.945 0 2.067c.655-1.045.73-1.051 1.625-.768 1.185.372 2.2.925 2.962 1.97.336.458.958.702 1.437 1.062 1.105.828 2.2 1.667 3.352 2.545 1.753-2.16 3.125-4.44 4.408-6.81C14.98-.215 15.897.46 16.86.99c1.132.625 1.239 1.768 1.45 2.965-.256.28-.52.675-.878.943-1.37 1.027-2.351 2.345-2.997 3.908-.366.884-.673 1.8-.902 2.726-.072.294.128.714.312 1.006.548.857 1.194 1.64 1.438 2.678.086.375.443.697.708 1.018 1.536 1.87 3.105 3.711 4.61 5.607.802 1.006 1.427 2.637 1.534 3.447-.881 1.267-1.682 2.395-2.456 3.541-1.27 1.881-2.506 3.786-3.786 5.66-.946 1.385-.946 1.596.012 2.962.848 1.211 1.575 2.509 2.468 3.684.785 1.033 1.711 1.965 2.607 2.914 1.5 1.586 2.452 3.464 3.015 5.554.02.074-.045.175-.11.396-1.212.047-2.226-.578-3.045-1.328-2.268-2.077-4.44-4.259-6.632-6.422-.395-.39-.678-.89-1.03-1.328-.348-.434-.743-.565-1.172-.101-.381.41-.825.786-1.11 1.253-.703 1.146-1.304 2.351-1.994 3.503-.307.512-.673 1.018-1.11 1.42-.638.583-1.498.333-1.57-.515-.095-1.15-.68-2.01-1.28-2.893-.481-.714-.618-1.438-.276-2.247.682-1.616 1.152-3.307 2.319-4.717.625-.76.893-1.813 1.369-2.834-.333-.55-.7-1.193-1.107-1.812-.563-.854-1.185-1.67-1.724-2.536C5 28.6 4.506 27.76 3.497 27.41a.679.679 0 0 1-.327-.247c-.703-1.04-1.453-2.054-2.066-3.146-.38-.676-.598-1.408.15-2.15.386-.383.526-1.07.657-1.648.366-1.625 1.384-2.913 2.179-4.31 1.053-1.845 2.226-3.621 3.315-5.38l-.003.003Zm3.379 19.379c1.223-2.328 2.5-4.634 3.646-7.003.473-.98.824-2.08-.354-2.994-.414-.322-.602-.926-.935-1.37-.512-.684-.8-1.57-1.601-1.967l-5.551 8.223 4.795 5.11ZM60.72 49c-1.029-1.492-2.021-2.675-2.719-4.016-.7-1.344-.578-2.91-.54-4.401.042-1.782.094-3.563.217-5.339.08-1.18-.203-2.145-1.054-3.008-2.766-2.808-5.492-5.659-8.203-8.463-.799.129-1.266.542-1.68 1.121-.75 1.055-1.614 2.029-2.352 3.089-.516.74-.986 1.535-1.328 2.367-.666 1.624-1.294 3.248-1.257 5.085.056 2.799-.12 5.6-.049 8.396.05 1.933-.424 3.625-1.58 5.144-2.225-1.254-3.518-3.298-3.546-5.739-.028-2.404.05-4.81.012-7.215-.046-2.977.04-5.98-.301-8.926-.369-3.196-.476-6.398-.673-9.6-.07-1.144.024-2.303.077-3.453.098-2.213.313-4.423.3-6.636-.008-1.507.013-3.094-1.044-4.413.716-.58 1.426-1.162 2.142-1.739.11-.09.246-.16.381-.197 1.266-.355 3.538 1.01 3.913 2.296.11.38.316.795.608 1.045.67.58 1.245 1.19 1.497 2.065.064.228.187.45.323.647 1.367 1.976 2.744 3.946 4.124 5.912.105.148.27.256.569.533.574-.958 1.213-1.797 1.61-2.737.618-1.458 1.543-2.644 2.64-3.75.76-.768 1.42-1.64 2.262-2.63.95.03 1.663-.798 2.148-1.75.212-.414.446-.746.78-.639 1.114.361 2.377.232 3.345 1.1.507.457.827.904.737 1.61-.224 1.763-.141 3.507.12 5.276.157 1.067-.178 2.2-.064 3.28.3 2.838-.145 5.674.07 8.507.123 1.627.246 3.257.305 4.888.07 1.976.049 3.957.12 5.933.06 1.732.233 3.461.282 5.197.068 2.296.12 4.595.065 6.891-.022.9-.369 1.773-1.027 2.49-.4.438-.685.98-1.226 1.779h-.003Zm-3.404-38.42c-.102-.036-.203-.073-.308-.113-.488.518-1.032.992-1.453 1.562-.965 1.304-1.85 2.67-2.81 3.98-.654.893-.875 1.735-.23 2.764.925 1.47 1.736 3 2.966 4.266.74.761 1.343 1.658 2.24 2.786-.12-2.81-.258-5.267-.322-7.724-.068-2.505-.062-5.014-.09-7.52h.007ZM45.124 19.16c-.597-.993-1.19-1.924-1.724-2.882-.532-.953-1.113-1.85-2.084-2.694-.117 3.828.181 7.415.56 11.33 1.18-2.09 2.187-3.878 3.248-5.755Z"/></svg>
      </div>
    </Wrapper>
  )
}

const Wrapper = styled.section`
  .container{
    display: grid;
    grid-template-columns: 352px 1fr;
    gap: 60px;
    width: fit-content;
    margin: 0 auto;
    position: relative;

    .rune {
      bottom: -120px;
      position: absolute;
      left: 50%;

      @media (max-width: 640px) {
        display: none;
      }
    }

    @media (max-width: 1024px) {
      gap: 24px;
    }

    @media (max-width: 948px) {
      grid-template-columns: 1fr;
    }
  }
`