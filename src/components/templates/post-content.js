import React, { useEffect } from "react"
import styled from "styled-components"
import { Gutenberg } from "../organisms/gutenberg-wrapper"
import Navigation from "../organisms/post-navigation"
import HTMLReactParser from "html-react-parser"
import useHeadings from "../../hooks/create-headings"
import { slugTransform } from "../../utils/slug-transform"

export default function Content({ data }) {
  const headings = useHeadings(data)

  useEffect(() => {
    document.getElementById('content').querySelectorAll('h2').forEach(el => {
      el.id = slugTransform(el.innerText)
    })
  }, [])


  return (
    <Wrapper>
      <div className="container">
        <Navigation headings={headings} />
        <Gutenberg id='content'>{HTMLReactParser(data)}</Gutenberg>
        <svg className="runes" width="63" height="50" viewBox="0 0 63 50" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.40241 10.5308C6.82795 9.02783 5.82787 8.16475 4.71766 7.33738C2.7919 5.90288 1.41679 3.94457 0 2.06662C0.654817 1.022 0.729228 1.01604 1.62514 1.29878C2.80976 1.6708 3.82473 2.22436 4.58669 3.26899C4.92303 3.72731 5.54511 3.97136 6.02431 4.33147C7.12857 5.15884 8.2239 5.99811 9.37579 6.87608C11.1289 4.71539 12.501 2.43567 13.7839 0.066654C14.9804 -0.21608 15.8972 0.459505 16.8615 0.989259C17.9926 1.61425 18.0997 2.75709 18.3111 3.9535C18.0551 4.23326 17.7902 4.62909 17.433 4.89694C16.0638 5.92371 15.0816 7.24214 14.4357 8.80462C14.0696 9.68853 13.7631 10.6052 13.5339 11.5308C13.4624 11.8254 13.6619 12.245 13.8464 12.5367C14.3941 13.3938 15.04 14.1766 15.284 15.2152C15.3703 15.5902 15.7275 15.9117 15.9924 16.2331C17.5283 18.1021 19.0968 19.9443 20.6029 21.8401C21.4036 22.8461 22.0286 24.477 22.1358 25.2865C21.2548 26.5543 20.4541 27.6823 19.6802 28.8281C18.4093 30.7091 17.1741 32.6138 15.8942 34.4888C14.9477 35.8727 14.9477 36.084 15.9061 37.45C16.7544 38.6613 17.4806 39.9589 18.3736 41.1345C19.1593 42.1672 20.085 43.0987 20.9809 44.0481C22.4811 45.6344 23.4335 47.5124 23.9961 49.6016C24.0169 49.676 23.9514 49.7772 23.8859 49.9975C22.6745 50.0451 21.6596 49.4201 20.841 48.6701C18.573 46.5927 16.4002 44.4112 14.2095 42.2476C13.8137 41.8577 13.5309 41.3577 13.1797 40.9202C12.8314 40.4857 12.4356 40.3547 12.007 40.819C11.626 41.2297 11.1825 41.6047 10.8967 42.072C10.1943 43.2178 9.59307 44.4231 8.90253 45.5749C8.59596 46.0868 8.22986 46.5927 7.79232 46.9945C7.15536 47.5778 6.29517 47.3278 6.22374 46.4796C6.12849 45.3309 5.54213 44.4707 4.94387 43.5868C4.46168 42.8726 4.32477 42.1494 4.66706 41.3398C5.34866 39.7238 5.81894 38.0333 6.9857 36.6227C7.61076 35.8637 7.87864 34.8102 8.35487 33.7894C8.02151 33.2388 7.6554 32.5959 7.24763 31.9769C6.68508 31.1227 6.06301 30.3073 5.52427 29.4412C5.00042 28.599 4.50633 27.7597 3.49732 27.4085C3.37231 27.3639 3.24134 27.2716 3.16991 27.1615C2.46747 26.1228 1.71741 25.1079 1.10426 24.0157C0.723275 23.3401 0.505995 22.608 1.25308 21.8669C1.64002 21.483 1.77991 20.7955 1.91087 20.2181C2.27698 18.5932 3.29492 17.3045 4.08963 15.9087C5.14329 14.0635 6.31601 12.2867 7.40538 10.5278L7.40241 10.5308ZM10.7807 29.9085C12.004 27.5811 13.2809 25.2746 14.4268 22.9056C14.9001 21.9264 15.2513 20.8253 14.0726 19.9116C13.6589 19.5902 13.4714 18.986 13.138 18.5426C12.6261 17.8581 12.3373 16.9712 11.5367 16.5753C9.65855 19.358 7.82804 22.0693 5.98562 24.7984C7.6435 26.5663 9.19422 28.218 10.7807 29.9085Z" fill="#9AACB8" fillOpacity="0.3" />
          <path d="M60.7209 49C59.6913 47.5082 58.6986 46.3247 58.001 44.9839C57.3003 43.6401 57.4232 42.0744 57.4601 40.5826C57.5031 38.8011 57.5554 37.0196 57.6783 35.2443C57.7582 34.0638 57.4754 33.0991 56.6241 32.2361C53.8581 29.4283 51.132 26.5773 48.4213 23.7725C47.6223 23.9019 47.1551 24.3149 46.7402 24.8944C45.9903 25.9485 45.1267 26.9225 44.3891 27.9827C43.8728 28.7224 43.4026 29.5176 43.0614 30.3498C42.3945 31.9741 41.7675 33.5984 41.8044 35.4354C41.8597 38.234 41.6845 41.0357 41.7552 43.8312C41.8044 45.7637 41.3311 47.4558 40.1755 48.9753C37.9504 47.7209 36.6565 45.6774 36.6289 43.2364C36.6012 40.8323 36.6781 38.4251 36.6412 36.021C36.5951 33.0436 36.6811 30.0416 36.34 27.0951C35.9712 23.8989 35.8636 20.6965 35.6669 17.4941C35.5962 16.3506 35.6915 15.1917 35.7438 14.0421C35.8421 11.8291 36.0572 9.61919 36.0449 7.40619C36.0357 5.89902 36.0572 4.3117 35 2.99253C35.7161 2.41309 36.426 1.83056 37.1421 1.25419C37.2528 1.16481 37.388 1.09392 37.5232 1.05694C38.7894 0.702487 41.0607 2.06789 41.4356 3.35315C41.5462 3.73225 41.7522 4.14835 42.0441 4.398C42.7141 4.97745 43.2888 5.58772 43.5409 6.46305C43.6054 6.69113 43.7283 6.91305 43.8636 7.11031C45.2312 9.08597 46.6081 11.0555 47.988 13.0219C48.0925 13.1698 48.2585 13.2777 48.5566 13.5551C49.1313 12.5966 49.7705 11.7582 50.167 10.8181C50.7848 9.36029 51.7098 8.17365 52.807 7.06716C53.5661 6.2997 54.2269 5.42744 55.069 4.43807C56.0187 4.46889 56.7317 3.63979 57.2173 2.6874C57.4293 2.27439 57.6629 1.94152 57.9979 2.04939C59.1105 2.41001 60.3736 2.28055 61.3417 3.14973C61.8488 3.60589 62.1685 4.0528 62.0793 4.75861C61.855 6.52161 61.938 8.26612 62.1992 10.0353C62.3559 11.1017 62.0209 12.2359 62.1347 13.3147C62.4358 16.1534 61.9902 18.989 62.2053 21.8215C62.3283 23.4489 62.4512 25.0793 62.5096 26.7098C62.5803 28.6855 62.5588 30.6673 62.6295 32.643C62.6909 34.3751 62.863 36.1042 62.9122 37.8395C62.9798 40.1357 63.0321 42.435 62.9768 44.7312C62.9552 45.6312 62.608 46.5035 61.9503 47.2216C61.5507 47.6593 61.2649 48.2017 60.724 49H60.7209ZM57.3156 10.5808C57.2142 10.5438 57.1128 10.5069 57.0083 10.4668C56.5196 10.9846 55.9757 11.4592 55.5546 12.0294C54.5896 13.3332 53.7044 14.6986 52.7456 16.0085C52.0909 16.9023 51.8696 17.7438 52.5151 18.7732C53.4401 20.2434 54.2515 21.7722 55.4808 23.0389C56.2215 23.8002 56.8239 24.6971 57.7213 25.8252C57.6015 23.0143 57.4632 20.5578 57.3986 18.1013C57.331 15.5955 57.3371 13.0866 57.3095 10.5808H57.3156ZM45.1236 19.1585C44.5274 18.166 43.9342 17.2352 43.3995 16.2767C42.8678 15.3243 42.2869 14.4274 41.3157 13.5829C41.199 17.4109 41.4971 20.9985 41.8751 24.9129C43.0553 22.8232 44.0633 21.0355 45.1236 19.1585Z" fill="#9AACB8" fillOpacity="0.3" />
        </svg>
      </div>
    </Wrapper>
  )
}

const Wrapper = styled.section`
  .container{
    display: grid;
    grid-template-columns: 352px 1fr;
    gap: 60px;
    width: fit-content;
    margin: 0 auto;
    position: relative;

    .runes{
      bottom: -120px;
      position: absolute;
      left: 50%;

      @media (max-width: 640px) {
        display: none;
      }
    }

    @media (max-width: 1024px) {
      gap: 24px;
    }

    @media (max-width: 948px) {
      grid-template-columns: 1fr;
    }
  }
`